<template>
  <router-link
    class="nav-link"
    :to="link"
    v-if="!isExternal(link)"
    :exact="exact"
  >{{ item.text }}</router-link>
  <a
    v-else
    :href="link"
    class="nav-link external"
    :target="isMailto(link) || isTel(link) ? null : '_blank'"
    :rel="isMailto(link) || isTel(link) ? null : 'noopener noreferrer'"
  >
    <svg
      v-if="link.includes('github')"
      xmlns="http://www.w3.org/2000/svg"
      width="16"
      height="16"
      viewBox="0 0 26 25">
      <path
        fill="#fff"
        d="M2422.26,85.382a13.1,13.1,0,0,0-22.52,0,12.428,12.428,0,0,0-1.74,6.435,12.3,12.3,0,0,0,2.48,7.537,12.712,12.712,0,0,0,6.41,4.632,0.752,0.752,0,0,0,.67-0.117,0.636,0.636,0,0,0,.22-0.5c0-.034,0-0.334-0.01-0.9v-1.485l-0.39.066a5.116,5.116,0,0,1-.94.059,7.364,7.364,0,0,1-1.18-.117,2.619,2.619,0,0,1-1.13-.5,2.151,2.151,0,0,1-.75-1.027l-0.17-.384a4.132,4.132,0,0,0-.53-0.851,2.01,2.01,0,0,0-.74-0.634l-0.12-.083a1.286,1.286,0,0,1-.22-0.2,1.5,1.5,0,0,1-.15-0.234,0.147,0.147,0,0,1,.09-0.192,1.1,1.1,0,0,1,.49-0.075l0.34,0.05a2.471,2.471,0,0,1,.83.4,2.585,2.585,0,0,1,.82.868,3.024,3.024,0,0,0,.94,1.043,2.029,2.029,0,0,0,1.11.359,4.856,4.856,0,0,0,.97-0.083,3.427,3.427,0,0,0,.76-0.25,2.689,2.689,0,0,1,.83-1.719,12.125,12.125,0,0,1-1.74-.3,7.071,7.071,0,0,1-1.59-.652,4.615,4.615,0,0,1-1.36-1.118,5.348,5.348,0,0,1-.89-1.753,8.262,8.262,0,0,1-.35-2.5,4.841,4.841,0,0,1,1.34-3.439,4.4,4.4,0,0,1,.12-3.405,2.419,2.419,0,0,1,1.46.225,10.392,10.392,0,0,1,1.41.643q0.45,0.267.72,0.451a12.389,12.389,0,0,1,6.5,0l0.64-.4a9.134,9.134,0,0,1,1.56-.735,2.247,2.247,0,0,1,1.37-.184,4.369,4.369,0,0,1,.14,3.405,4.841,4.841,0,0,1,1.34,3.439,8.345,8.345,0,0,1-.35,2.512,5.065,5.065,0,0,1-.9,1.753,4.71,4.71,0,0,1-1.37,1.11,7.071,7.071,0,0,1-1.59.652,11.832,11.832,0,0,1-1.74.3,2.94,2.94,0,0,1,.88,2.37v3.521a0.638,0.638,0,0,0,.22.5,0.731,0.731,0,0,0,.66.117,12.708,12.708,0,0,0,6.41-4.633,12.3,12.3,0,0,0,2.48-7.537A12.426,12.426,0,0,0,2422.26,85.382Z" transform="translate(-2398 -79)"/>
    </svg>
    <span>{{ item.text }}</span>
    <OutboundLink v-if="!link.includes('github') && !link.includes('storyscript.io')" />
  </a>
</template>

<script>
import { isExternal, isMailto, isTel, ensureExt } from '../util'

export default {
  props: {
    item: {
      required: true
    }
  },

  computed: {
    link () {
      return ensureExt(this.item.link)
    },

    exact () {
      if (this.$site.locales) {
        return Object.keys(this.$site.locales).some(rootLink => rootLink === this.link)
      }
      return this.link === '/'
    }
  },

  methods: {
    isExternal,
    isMailto,
    isTel
  }
}
</script>
